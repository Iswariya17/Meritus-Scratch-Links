const ArgumentType = require('../../extension-support/argument-type');
const BlockType = require('../../extension-support/block-type');
const Clone = require('../../util/clone');
const Cast = require('../../util/cast');
const Timer = require('../../util/timer');
const request = require('request');
const RenderedTarget = require('../../sprites/rendered-target');

// sentiment
const sentiment = require('sentiment');
let localSentiment = 1;
let feeling;
const ajax = require('es-ajax');
//const iconURI = require('./assets/sentiment_icon');
const blockIconURI = "data:image/png;base64,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UmVhZHlxyWU8AAADI2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDIgNzkuMTY0NDYwLCAyMDIwLzA1LzEyLTE2OjA0OjE3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjEuMiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6ODBBMjZBQTREODlFMTFFQUI2QkJCRUJGMzlDOTE4RTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6ODBBMjZBQTVEODlFMTFFQUI2QkJCRUJGMzlDOTE4RTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4MEEyNkFBMkQ4OUUxMUVBQjZCQkJFQkYzOUM5MThFNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4MEEyNkFBM0Q4OUUxMUVBQjZCQkJFQkYzOUM5MThFNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PvdsCgkAABOGSURBVHja7FsJeBRVtj7pJUl3J6TJHrZsIKgoQUAlyiRRUHBANhERDNERFIeZAM9xfE95wNOZ0XF8wOc449MHJDMoq7KPjzUJ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";

class Scratch3Sentiment {
    constructor (runtime) {
        this.runtime = runtime;
  
    }

    getInfo () {
        return {
            id: 'sentiment',
            name: 'SA w Scratch',
            blockIconURI: blockIconURI,
            blocks: [
                {
                    opcode: 'whenPositive',
                    blockType: BlockType.HAT,
                    text: 'When text is positive'
                },
                {
                    opcode: 'whenNegative',
                    blockType: BlockType.HAT,
                    text: 'When text is negative'
                },
                {
                    opcode: 'whenNeutral',
                    blockType: BlockType.HAT,
                    text: 'When text is neutral'
                },
                {
                    opcode: 'getFeeling',
                    blockType: BlockType.REPORTER,
                    text: 'What is the feeling of the text: [phrase]?',
                    arguments: {
                        phrase: {
                            type: ArgumentType.STRING,
                            defaultValue: 'your text here'
                        }
                    }
                }
                
            ],
            menus: {
             	trueFalse: ['true', 'false']
            }
        };
    }

    getFeeling (args, util){
        const text = args.phrase;
        localSentiment = sentiment(text);
        console.log(sentiment(text));
        if (localSentiment.score >= 2){
            feeling = 'positive';
        } else if (localSentiment.score < 0){
            feeling = 'negative';
        } else {
            feeling = 'neutral';
        }
        return feeling;
    }
  
    whenPositive (args, util) {
        if (feeling == 'positive'){
            return true;
        }
        return false;
    }
    
    whenNegative (args, util) {
        if (feeling == 'negative'){
            return true;
        }
        return false;         
    }

    whenNeutral (args, util) {
        if (feeling == 'neutral'){
            return true;
        }
        return false;
    }
}

module.exports = Scratch3Sentiment;